{% extends "base.html" %}

{% block content %}

<div class="card">

    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">

        <h2>
            
            Welcome, {{ username }}.
        
        </h2>

        <a href="/" class="button">
            
            New Scan
        
        </a>

    </div>

    <h3>
        
        Scan History
    
    </h3>
    
    <div class="table-container">
    
        <table>
    
            <thead>
    
                <tr>
    
                    <th>Time</th>
                    <th>File Name</th>
                    <th>File Type</th>
                    <th>Status</th>

                </tr>
            
            </thead>

            <tbody>

                {% for log in logs %}

                <tr>

                    <td data-ts="{{ log.timestamp }}"></td>
                    <td>{{ log.filename }}</td>
                    <td>

                        <code>
                        
                            {{ log.filetype }}
                        
                        </code>
                    
                    </td>
                    
                    <td>
                        <span class="status-badge {% if log.status == 'Unknown' %} badge-unknown {% elif 'Mismatch' in log.status %} badge-mismatch {% else %} badge-match {% endif %}">

                            {{ log.status }}

                        </span>

                    </td>

                    <td>
    
                        <form method="post" action="{{ url_for('delete_log', log_id=log.log_id) }}">
        
                            <button type="submit" class="button-delete">
    
                                Delete

                            </button>
    
                        </form>

                    </td>

                </tr>

                {% else %}

                <tr>

                    <td colspan="4" style="text-align: center; color: var(--text-muted); padding: 2rem;">
        
                        No scans yet. 
                        
                        <a href="/" style="color: var(--primary);">
                            
                            Analyse a file
                        
                        </a>
                        
                        to get started.
                    
                    </td>
                
                </tr>

                {% endfor %}

            </tbody>

        </table>

    </div>

    <div class="card" style="margin-top: 2rem; border: 1px solid var(--color-danger);">

        <h3 style="margin-bottom: 1rem;">
            
            Delete Account
        
        </h3>
    
        {% if error %}
    
        <div style="color: var(--color-danger); margin-bottom: 1rem;">
            
            {{ error }}
        
        </div>

        {% endif %}

        <p style="margin-bottom: 1rem; color: var(--text-muted);">
            
            This will permanently delete your account and all scan history. Enter your password to confirm.
        
        </p>

        <form method="post" action="{{ url_for('delete_account') }}">

            <input type="password" name="password" class="form-input" placeholder="Enter your password" required>

            <button type="submit" class="button" style="background: var(--color-danger); color: var(--bg-header);">
            
                Delete Account
        
            </button>

        </form>

    </div>

</div>

{% endblock %}